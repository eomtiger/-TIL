# 프로세스와 스레드에 대한 설명
프로세스는 운영체제로부터 자원을 할당받은 작업의 단위이고,
스레드는 프로세스가 할당받안 자원을 활용하는 실행 흐름의 단위입니다.

<br> 

# 프로세스와 스레드의 차이점
프로세스와 스레드는 **자원을 공유**하는 부분에서 차이점이 있습니다.  
**프로세스**는 **독립적인 메모리 공간**을 할당받기에 자원 공유가 어렵고    
**스레드**는 스택 영역을 제외한 **나머지(데이터, 코드, 힙) 영역을 공유**하고 있다는 차이점이 있습니다. 이로 인해 스레드는 프로세스에 비해 컨텍스트 스위칭 오버헤드가 작다는 장점이 있습니다.

<br>
<br>

## 배경 지식

### 프로세스(Process)

> 프로세스란 프로그램을 메모리에 적재하여 CPU를 할당 받아 실행 중인 프로그램운영체제로부터 자원을 할당받은 작업의 단위
> 

각각의 **프로세스**는 **독립된 메모리 공간**을 할당 받는다.

---

### 스레드(Thread)

> 스레드란 프로그램 안에서 실행되는 여러 흐름 단위프로세스가 할당받은 자원을 이용하는 실행 흐름의 단위
> 

기본적으로 **프로세스**는 최소 1개의 **스레드**를 소유하고 있다.

---

## 프로세스의 자원 구조

프로세스는 다음과 같이 4가지의 메모리 영역으로 구성되어 할당 받게 된다.

**코드 영역(CODE)** : 프로그래머가 작성한 프로그램 함수들의 코드들이 CPU가 해석 가능한 기계어 형태로 저장되어 있다.

**데이터 영역(DATA)** : 코드가 실행되면서 사용하는 전역 변수나 각종 데이터들이 모여 있다.

- 초기화 된 데이터는 data 영역에 저장
- 초기화 되지 않은 데이터는 bss 영역에 저장

**힙 영역(HEAP)** : 생성자, 인스턴스와 같은 동적으로 할당되는 데이터들을 위한 공간이다. 사용자에 의해 메모리 공간이 동적으로 할당되고 해제된다.

**스택 영역(STACK)** : 지역 변수와 같은 호출한 함수가 종료되면 되돌아올 임시적인 자료를 저장하는 독립적인 공간이다. Stack은 함수 호출과 함께 할당되며, 함수의 호출이 완료되면 소멸한다.

```markdown
코드 영역과 데이터 영역은 선언할 때 크기가 결정되는 **정적 영역**이지만 힙 영역과 스택 영역은 프로세스가 실행되는 동안 크기가 변화하는 **동적 영역**이다.
```

![](https://github.com/junhong625/TIL/assets/83000975/493b360d-fd06-42fb-9d9f-62eddbeb0ced)

---

## 프로세스의 자원 공유

기본적으로 각 프로세스는 별도의 메모리 주소 공간에서 실행되기에, 한 프로세스는 다른 프로세스의 변수나 자료구조에 접근할 수 없다. 하지만 아래와 같은 특별한 방법을 통해 프로세스 간 정보 공유는 가능하다.

1. IPC(Inter-Process Communication)
2. LPC(Local-Process Communication)
3. 별도로 공유 메모리를 만들어 정보를 주고받도록 설정

하지만 이러한 자원 공유는 CPU 레지스터 교체뿐만이 아니라 RAM과 CPU 사이의 캐시 메모리까지 초기화되기 때문에 자원 부담이 크다는 단점이 존재한다. 그래서 **다중 작업이 필요한 경우 스레드를 이용하는 것이 훨씬 효율적**이다.

---

## 스레드의 자원 공유

스레드는 **프로세스가 할당 받은 자원을 이용하는 실행의 단위**로서, 스레드가 여러개 있으면 파일을 다운 받으며 동시에 웹 서핑을 할 수 있게 해준다. 스레드끼리 프로세스의 자원을 공유하면서 프로세스 실행 흐름의 일부가 되기 때문에 동시 작업이 가능한 것이다.

프로세스의 4가지 메모리 영역(Code, Data, Stack, Heap) 중 스레드는 Stack만 할당받아 복사하고 Code, Data, Heap은 프로세스 내의 다른 스레드와 공유한다. 

→ 따라서 각각의 스레드는 별도의 Stack을 가지고 있지만 Heap 메모리는 고유하기 때문에 서로 다른 스레드에서 가져와 읽고 쓸 수 있게 된다.

```markdown
❗stack은 지역 변수, 함수 호출 시 전달되는 인자, 되돌아갈 주소 값 저장하는 메모리 공간이기 때문에
독립적인 스택을 가졌다는 것은 **독립적인 함수 호출이 가능하다** 라는 의미이다.
그리고 독립적인 함수 호출이 가능하다는 것은 **독림적인 실행 흐름이 추가된다**는 의미이다.
```

> 이렇게 구성함으로써 하나의 프로세스를 다수의 실행 단위인 스레드로 구분하여 자원을 공유하고, 자원의 생성과 관리의 중복성을 최소하하여 수행 능력을 향상 시켰다.
> 

---

## 프로세스와 스레드의 차이점

**프로세스** - 자신만의 **고유** 공간과 자원을 할당받아 사용(독립적)

**스레드** - 다른 스레드와 stack을 제외한 나머지 공간과 자원을 **공유**하면서 사용

위와 같은 차이점으로 인해 스레드는 프로세스보다 빠르게 Context Switching 작업이 가능하다.

```markdown
❗Context Switching이란?

cpu에서 현재 작업 중인 프로세스에서 다른 프로세스로 넘어갈 때 지금까지의 프로세스의 상태를 저장하고, 새 프로세스의 저장된 상태를 다시 적재하는 작업을 Context Switching이라 한다.

```

---