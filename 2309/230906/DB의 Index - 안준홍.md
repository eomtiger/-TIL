# Index란?
추가적인 쓰기 작업과 저장 공간을 활용하여 DB 테이블의 검색 속도를 향상시키기 위해 사용되는 자료 구조입니다.
Index를 사용하면 RDBMS에서 레코드를 처음부터 풀스캔하지 않고, B+Tree로 구성된 구조에서 Index 파일 검색으로 속도를 향상시키는 기술입니다.

<br>

## 인덱스 파일 구성
테이블 생성 시, 3가지 파일이 생성됩니다.
- FRM: 테이블 구조 저장 파일
- MYD: 실제 데이터 파일
- MYI: Index 정보 파일(Index 사용 시 생성)

사용자가 쿼리를 통해 Index를 사용하는 칼럼을 검색하게 되면, 이때 MYI 파일의 내용을 활용합니다.

<br>

## 인덱스 장점
- 적절한 인덱스를 생성하고 사용하면 **조회 성능을 개선**할 수 있습니다.  
    -> 인덱스에 의해 데이터들이 정렬된 형태를 갖게 되고 이로 인해 Full Table Scan 작업을 하지 않아도 빠르게 조건에 맞는 데이터 탐색이 가능해집니다.

<br>

## 인덱스 단점
- 인덱스를 관리하기 위해 DML 작업 시 추가 작업이 필요합니다.
- 인덱스는 대략 테이블 크기의 10% 정도되는 추가 공간이 필요합니다.(인덱스 페이지 때문)
- select가 아닌 데이터의 변경 작업(DML)이 자주 일어나면 오히려 성능에 악영향을 끼칩니다.(페이지 정렬 작업 때문)

<br>

## 인덱스 종류
### 클러스터형 인덱스(Cluster Index)
- 테이블당 1개만 존재할 수 있습니다.
- PK로 지정된 컬럼은 자동으로 클러스터링 인덱스가 생성됩니다.
- 클러스터링 인덱스를 기준으로 데이터가 자동 정렬됩니다.  
  
### 보조 인덱스(Secondary Index/non-Clusted Index)
- 한 테이블에 여러개 설정이 가능합니다.
- 클러스터링 인덱스와 달리 데이터를 정렬하지 않습니다.
- 직접 보조 인덱스 생성이 가능합니다.

<br>

## 인덱스의 자료구조
인덱스에는 여러 자료구조가 있는데 대표적으로 해시 테이블(Hash Table)과 B+Tree가 있다.
    
### 해시 테이블(Hash Table)
- Key와 Value를 한 쌍으로 데이터를 저장하는 자료구조다.
- O(1)의 매우 빠른 시간만에 탐색이 가능한 구조다.
- 등호 연산에 최적화 되어있기 때문에 부등호 연산을 자주 사용하는 DB Index에서 잘 사용되지 않는 구조다.

### B+Tree
- 한 데이터의 검색은 효율적이지만 모든 데이터를 순회하는데 비효율적인 B-Tree의 단점을 개선시킨 자료구조다.
- 오직 leaf node에만 데이터를 저장하고 나머지 노드에는 자식 포인터만 저장합니다.
- leaf node끼리는 Linked List로 연결되어 있어 부등호 연산이 자주 일어나는 DB Index에 자주 사용되는 구조입니다.
- leaf node를 제외하고 데이터를 저장하지 않기 때문에 메모리를 더 확보할 수 있다. 따라서 하나의 node에 더 많은 포인터를 가질 수 있기 때문에 트리의 높이가 더 낮아지므로 검색 속도를 높일 수 있다.
- Full Scan의 경우 선형 시간이 소모됩니다.

<br>

## 인덱스 사용시 유의사항
1. 카디널리티(cardinality)가 높은(중복도가 낮은)열에 인덱스를 설정해야 합니다.
- 중복도가 높은 컬럼에 설정할 경우, 별다른 성능 향상의 결과를 얻지 못하기 때문입니다.
2. WHERE 절에 자주 사용되는 열에 인덱스를 만들어야 합니다.
- WHERE 절에 사용되는 열에 인덱스를 설정해야 효율적으로 인덱스를 사용할 수 있기 때문입니다.
3. 잘 사용되지 않는 인덱스는 과감히 제거합니다.
- 인덱스는 테이블 데이터 크기의 약 10%를 차지하는 개체입니다. 또한, 데이터 변경 작업 시 페이지 분할작업으로 인해 성능에 악영향을 미칠 수 있기 때문에 필요 없다면 제거하는게 좋습니다.
4. DML 작업이 빈번한 테이블에서는 인덱스 사용을 고려해야 합니다.
- 데이터 변경 작업이 빈번하다면 페이지 분할 작업으로 인해 조회 성능을 제외한 다른 작업 성능이 느려지기 때문입니다.

---
### 참고
- https://rachel0115.tistory.com/entry/MySQL-%EC%9D%B8%EB%8D%B1%EC%8A%A4-INDEX-%EC%A0%95%EB%A6%AC-%EB%8F%99%EC%9E%91-%EB%B0%A9%EC%8B%9D-%EC%83%9D%EC%84%B1-%EC%82%AD%EC%A0%9C-%EC%84%A4%EA%B3%84#%EC%9D%B8%EB%8D%B1%EC%8A%A4%20%EC%82%AC%EC%9A%A9%EC%8B%9C%20%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD-1
- https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Database/%5BDB%5D%20Index.md
- https://lalwr.blogspot.com/2016/02/db-index.html